# Kraken API Credentials
# Get your API keys from: https://www.kraken.com/u/security/api
KRAKEN_API_KEY=your_api_key_here
KRAKEN_API_SECRET=your_api_secret_here

# Trading Configuration
# Single-coin mode (adaptive_bot.py)
TRADING_PAIR=XBTUSD
ORDER_SIZE=0.0001  # Kraken minimum: $10.60 @ $106k BTC (Nov 2025)

# Multi-coin mode (multi_coin_bot.py)
# Comma-separated list of trading pairs
# RECOMMENDED 2025 PORTFOLIO: BTC (liquidity leader), ETH (DeFi stability), SOL (volatility), XRP (institutional momentum)
TRADING_PAIRS=PEPEUSD,DOGEUSD,ARBUSD

# Portfolio position sizing
MAX_TOTAL_EXPOSURE=75    # Max % of account in positions across all coins
MAX_PER_COIN=25          # Max % of account per single coin

# Balance-based sizing mode for multi-coin
# Options: pct, equal (recommended)
POSITION_SIZING_MODE=equal

# Hold back this % of quote balance for fees/slippage before splitting
FEE_BUFFER_PCT=1.0

# Risk Management
STOP_LOSS_PERCENTAGE=2.0
TAKE_PROFIT_PERCENTAGE=5.0

# Bot Settings
DRY_RUN=true
LOG_LEVEL=INFO

# Market data
# Candle interval (minutes) used for indicator calculations (ATR/ADX/volume surge, etc.)
OHLC_INTERVAL=1

# Rate Limiting (IMPORTANT for multi-coin trading!)
# Kraken rate limits: Starter tier = 0.33 points/sec refill, 15 max
# With 4 coins: 10 API calls per iteration = need 3+ sec between calls
# Recommended by tier:
#   Starter (most users):     API_CALL_DELAY=10.0
#   Intermediate:             API_CALL_DELAY=5.0
#   Pro:                      API_CALL_DELAY=1.0
API_CALL_DELAY=10.0

# Strategy Selection
# Options: mean_reversion, sma_crossover
STRATEGY=mean_reversion

# ==========================================
# SMA Crossover Strategy Parameters
# ==========================================
# (Only used if STRATEGY=sma_crossover or adaptive bot selects it)

# SMA Periods - CRITICAL for profitability
# OPTIMIZED: Balanced for quality signals and faster startup
# 50/120 provides good signal quality with faster data collection (4 min vs 11 min)
# Lower values = more trades but more false signals and fees
# Higher values = fewer trades but higher quality signals
FAST_SMA_PERIOD=50   # Fast moving average (was 20, then 10)
SLOW_SMA_PERIOD=120  # Slow moving average (was 200, optimized for startup speed)

# Minimum hold time (seconds) to prevent whipsaw trades
# Prevents rapid buy-sell cycles that only generate fees
# 300 = 5 minutes, 600 = 10 minutes, 1800 = 30 minutes
MIN_HOLD_TIME=900

# Minimum profit target (as decimal) before strategies will allow exits
# With taker fees ~0.26%/side on Kraken, round-trip fees are ~0.52%
# Setting this to ~1.0%+ helps avoid "winning gross / losing net" trades
MIN_PROFIT_TARGET=0.010

# Trend alignment filter - prevent counter-trend trading
# When enabled, won't go long in downtrends or short in uptrends
# CRITICAL: Prevents 71% of losing trades (from analysis)
ENABLE_TREND_FILTER=true

# Shared strategy state
HISTORY_SIZE=200

# Breakout strategy
ATR_MULTIPLIER=1.5
VOLUME_THRESHOLD=1.5
BREAKOUT_LOOKBACK=20
REQUIRE_RETEST=false

# Grid strategy
GRID_SIZE=10
GRID_SPACING_PCT=0.5

# ==========================================
# Mean Reversion Strategy Parameters
# ==========================================
# (Only used if STRATEGY=mean_reversion)

# RSI Settings
# OPTIMIZED: More aggressive thresholds for crypto volatility
# Traditional: 30/70, Conservative: 40/60, Aggressive: 35/65
# Crypto markets are more volatile, so 35/65 catches more opportunities
RSI_PERIOD=14
RSI_OVERSOLD=35      # Lowered from 40 for more buy signals
RSI_OVERBOUGHT=65    # Raised from 60 for more sell signals

# Bollinger Bands Settings
BB_PERIOD=20
BB_STD_DEV=2.0

# MACD Settings (used by MACD strategy / gating logic)
MACD_FAST=12
MACD_SLOW=26
MACD_SIGNAL=9

# Require histogram confirmation for MACD signals
MACD_HISTOGRAM_CONFIRM=true

# Auto-detect support/resistance from price history
AUTO_DETECT_LEVELS=true

# Optional manual levels (no defaults; only set these if you disable AUTO_DETECT_LEVELS)
# SUPPORT_LEVEL=
# RESISTANCE_LEVEL=
# SUPPORT_ZONE=
# RESISTANCE_ZONE=
# BREAKOUT_LOWER=
# BREAKOUT_UPPER=

# ==========================================
# Fibonacci Analysis Settings
# ==========================================

# Enable/disable Fibonacci retracement and extension analysis
# Fibonacci levels help identify high-probability support/resistance and profit targets
USE_FIBONACCI=true

# Lookback period for finding swing highs/lows (default: 50 candles)
# Longer period = more stable levels, shorter = more responsive to recent price action
FIB_LOOKBACK_PERIOD=50

# Tolerance for "near Fibonacci level" detection (percentage)
# Example: 1.0 = price must be within 1% of a Fibonacci level to trigger bonus
# Used in Mean Reversion strategy to boost signal confidence
FIB_TOLERANCE=1.0

# How Fibonacci Works in Your Bot:
#
# MEAN REVERSION STRATEGY:
# - Calculates Fibonacci retracement levels (23.6%, 38.2%, 50%, 61.8%, 78.6%)
# - When price is near key levels (especially 61.8% "golden ratio"), signal confidence increases
# - Allows slightly relaxed RSI thresholds when at Fibonacci levels (higher accuracy)
# - Example: Buy signal at 61.8% level with RSI 42 instead of requiring RSI < 40
#
# BREAKOUT STRATEGY:
# - Calculates Fibonacci extension levels (127.2%, 161.8%, 200%, 261.8%)
# - Uses extensions as profit targets after breakout confirmed
# - 161.8% (golden ratio extension) is primary profit target
# - Logs targets automatically when breakout detected
#
# KEY FIBONACCI LEVELS EXPLAINED:
# - 38.2%: Shallow retracement (weak pullback in strong trend)
# - 50.0%: Psychological midpoint (not a Fibonacci number but widely used)
# - 61.8%: GOLDEN RATIO - strongest retracement level, highest probability
# - 127.2%: First extension target for breakouts
# - 161.8%: Golden ratio extension - primary breakout profit target
#
# RECOMMENDATIONS:
# - Keep USE_FIBONACCI=true for BTC, ETH (they respect Fib levels strongly)
# - Use FIB_LOOKBACK_PERIOD=50 for swing trading, 30 for day trading
# - FIB_TOLERANCE=1.0 is balanced; use 0.5 for strict, 2.0 for loose matching

# ==========================================
# Adaptive Bot Settings
# ==========================================

# Re-analysis interval (seconds) - how often to check if strategy should change
# OPTIMIZED to 600 (10 min) for balanced responsiveness
# 3600 = 1 hour, 1800 = 30 minutes, 900 = 15 minutes, 600 = 10 minutes
REANALYSIS_INTERVAL=600

# Cooldown between strategy switches (seconds) - prevents excessive switching
# OPTIMIZED to 1200 (20 min) for faster adaptation while preventing thrashing
# 3600 = 1 hour, 1800 = 30 minutes, 1200 = 20 minutes
SWITCH_COOLDOWN=1200

# Number of consecutive analyses required before switching
# OPTIMIZED to 2 for faster response while still preventing noise
# Higher = more conservative, lower = more responsive
CONFIRMATIONS_REQUIRED=2

# Maximum strategy switches allowed per day
MAX_SWITCHES_PER_DAY=4

# Market Analyzer Thresholds
# ADX (trend strength): >25 = strong trend, <20 = weak/ranging
ADX_STRONG_TREND=25
ADX_WEAK_TREND=20

# Choppiness Index: >61.8 = choppy, <38.2 = trending
CHOPPINESS_CHOPPY=61.8
CHOPPINESS_TRENDING=38.2

# Range percentage thresholds
RANGE_TIGHT=5        # Below this = low volatility
RANGE_MODERATE=15    # Below this = range-bound, above = volatile

# Market analyzer indicator periods + caching
ADX_PERIOD=14
ATR_PERIOD=14
CHOP_PERIOD=14
SLOPE_PERIOD=14
RANGE_PERIOD=50
ANALYSIS_CACHE_TTL=30

# ==========================================
# Fee Accounting
# ==========================================

# Kraken Fee Structure (as decimals)
# Default tier: <$50k 30-day volume
MAKER_FEE=0.0016     # 0.16% for limit orders
TAKER_FEE=0.0026     # 0.26% for market orders

# Higher volume tiers (optional, adjust based on your tier):
# $50k-$100k:  MAKER_FEE=0.0014  TAKER_FEE=0.0024
# $100k-$250k: MAKER_FEE=0.0012  TAKER_FEE=0.0022

# Minimum Profit Thresholds
# Don't execute trades unless net profit exceeds these thresholds
MIN_PROFIT_PERCENT=0.005   # 0.5% minimum profit after fees (legacy setting)
SKIP_UNPROFITABLE_TRADES=true  # Skip trades that won't cover fees

# Fee Reporting
TRACK_FEES=true      # Enable fee tracking and reporting

# ==========================================
# PORTFOLIO SELECTION RATIONALE (Nov 2025)
# ==========================================
#
# Research-based cryptocurrency selection for optimal adaptive bot performance:
#
# 1. XBTUSD (Bitcoin) - TIER 1 ESSENTIAL
#    - Highest liquidity: $125.8M daily volume on Kraken BTC/USD pair
#    - Volatility: 18.37% (perfect for all 5 strategies)
#    - Best for: Mean Reversion (strongest mean reversion tendencies), Grid Trading
#    - Current: ~$106k (consolidating after $124k peak)
#
# 2. ETHUSD (Ethereum) - TIER 1 ESSENTIAL
#    - Liquidity: $14B+ daily volume globally, top 3 on Kraken
#    - Volatility: 15-22% (excellent for grid + breakout)
#    - Best for: Grid Trading, Mean Reversion, DeFi stability
#    - Current: ~$3,450 (recovered from April correction to $1,384)
#
# 3. SOLUSD (Solana) - TIER 1 RECOMMENDED
#    - Liquidity: $800M+ daily volume
#    - Volatility: 20-25% (highest among top coins)
#    - Best for: Breakout Strategy, Trend Following in volatile markets
#    - Current: ~$153 (strong retail favorite with many entry points)
#
# 4. XRPUSD (XRP) - TIER 1 RECOMMENDED (Replaces XMRUSD)
#    - Liquidity: 2.91B USD 24h volume, top 3 most liquid altcoin
#    - Institutional momentum: First US XRP ETF launched Sept 2025 ($1B open interest)
#    - Regulatory clarity: SEC lawsuit resolved Aug 2025, reclassified as commodity
#    - Kraken performance: XRP futures volume ($3.48B) exceeded SOL ($3.23B)
#    - Volatility: 3.01% (moderate - great for Mean Reversion and MACD)
#    - Best for: SMA Crossover (clear trends), MACD, institutional volume breakouts
#    - Current: ~$2.70 (up 151% YoY, targeting $3.81 EOY)
#
# WHY XRP REPLACED MONERO (XMRUSD):
#    - 10-20x higher liquidity and trading volume
#    - Institutional support (ETFs, futures, RLUSD stablecoin)
#    - Better trend clarity for SMA Crossover strategy
#    - Higher volume for Breakout strategy confirmation
#    - More predictable ranges for Grid Trading
#    - Regulatory clarity vs. privacy coin regulatory scrutiny
#
# STRATEGY-COIN MAPPING:
#    - Mean Reversion: BTC (best) > ETH > XRP
#    - SMA Crossover: XRP (best trends) > SOL > BTC
#    - MACD: ETH > XRP > BTC
#    - Breakout: SOL (best volatility) > ETH > XRP
#    - Grid Trading: BTC (predictable ranges) > ETH > ATOM
#
# FEE EFFICIENCY (0.52% round-trip taker fees):
#    - All coins profitable with >0.52% price movements
#    - BTC most efficient (high price, small % moves = profit)
#    - Consider using limit orders (maker: 0.32% round-trip) for better efficiency
#
# CURRENT MARKET CONDITIONS (November 2025):
#    - Fear & Greed Index: 21 (extreme fear = Mean Reversion opportunity)
#    - Institutional activity: Record ETF inflows in Q4 2025
#    - Bull run status: Consolidation phase, potential continuation into 2026
#    - Best strategies: Mean Reversion, Grid Trading, watch for Breakouts
#
# For more information, see research conducted November 2025 on:
#    - Kraken liquidity and trading volumes
#    - 2025 cryptocurrency volatility patterns
#    - Institutional developments (ETFs, futures, regulations)
#    - Strategy-specific performance analysis
